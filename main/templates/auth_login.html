{% extends "base.html" %}
{% load static %}

{% block title %}
Sign in to comment
{% endblock %}

{% block extra_css %}
{# Only include what this page needs (main.css is already in base.html) #}
<link rel="stylesheet" href="{% static 'css/contact.css' %}" />
<link rel="stylesheet" href="{% static 'css/home.css' %}" />
{% endblock %}

{% block content %}

<main class="container my-5">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
      <div class="card shadow-lg">
        <div class="card-body p-4">
          <h1 class="h4 mb-3 text-center">
            Sign in to comment
          </h1>

          <p class="text-muted text-center mb-4">
            Use your comment account to sign in and leave feedback on projects.
          </p>

          <form method="post" novalidate>
            {% csrf_token %}

            <div class="mb-3">
              <label for="id_email" class="form-label">
                Email
              </label>
              <input
                type="email"
                name="email"
                id="id_email"
                class="form-control"
                required
                value="{{ email|default:'' }}"
                placeholder="you@example.com"
              />
            </div>

            <div class="mb-3">
              <label for="id_password" class="form-label">
                Password
              </label>
              <input
                type="password"
                name="password"
                id="id_password"
                class="form-control"
                required
                placeholder="Your password"
              />
            </div>

            {# Redirect back to where user came from, fallback to home #}
            <input
              type="hidden"
              name="next"
              value="{{ request.GET.next|default:request.META.HTTP_REFERER|default_if_none:'' }}"
            />

            <div class="d-grid">
              <button type="submit" class="btn btn-primary">
                Sign in
              </button>
            </div>
          </form>

          <p class="mt-3 mb-0 text-center small text-muted">
            Changed your mind?
            <a href="{% url 'home' %}">Go back to projects</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</main>

{% endblock %}

{% block inline_scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const alerts = document.querySelectorAll(".auto-dismiss");

    alerts.forEach((alert) => {
      if (!alert.classList.contains("alert-success")) return;

      setTimeout(() => {
        alert.style.transition =
          "opacity 0.5s ease, max-height 0.5s ease";
        alert.style.opacity = "0";
        alert.style.maxHeight = "0";

        setTimeout(() => {
          if (alert.parentNode) {
            alert.parentNode.removeChild(alert);
          }
        }, 500);
      }, 5000);
    });
  });
</script>
{% endblock %}
